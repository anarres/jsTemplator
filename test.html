<html>
<head>
<style>
body {
    padding: 20px 100px;
    font-family: Helvetica;
    color: #505050;

}
h1 {
    font-size: 2.5em;
    font-weight: normal;
}
p {
    padding: 5px 0px;
}
textarea {
    display: block;
    clear: both;
}
</style>

<script>
/* This is the javascript way of defining a class 
http://www.w3schools.com/js/js_objects.asp */
function replacement(niceName, shortName) {
    this.niceName = niceName;
    this.shortName = shortName;
    this.startString = "<!--" + shortName + "START-->";
    this.endString= "<!--" + shortName + "END-->";
}

/* This will go in a separate file so it can basically act like a config file */
var replacements = new Array(
    new replacement('Page title', 'pageTitle'),
    new replacement('Page content', 'pageContent'),
    new replacement('Footer', 'footer')
);

/* This will also be a separate file FIXME */
var basicTemplate = " \
<html><h1><!--pageTitleSTART--><!--pageTitleEND--></h1> \
<!--pageContentSTART--> <!--pageContentEND--> \
<p><!--footerSTART--> <!--footerEND--></p></html>";

/* Generate HTML */
function getStarted() {
    document.write("<h1>Exciting javascript templating system</h1>");
    for ( var i=0; i<replacements.length; i++ ) {
        document.write("<p>");
        document.write(replacements[i].niceName);
        document.write(': ');
        document.write("<br><input type='text' size='50' ");
        document.write(" id='");
        document.write(replacements[i].shortName);
        document.write("' name='");
        document.write(replacements[i].shortName);
        document.write("'>");
        document.write("</p>");
    }
}
getStarted();

/* Takes template, removes the section from startString to endString
inclusive, replaces this with insertText, and returns the result */
function replaceFoo(template, startString, endString, insertText) {
    var stringArray = template.split(startString);
    if( stringArray.length != 2 ) { alert('DEBUG 1: ' + stringArray); } // DEBUG 1
    var outputString = stringArray[0];
    outputString += startString;
    outputString += insertText;
    outputString += endString;
    var stringArray2 = stringArray[1].split(endString);
    if( stringArray2.length != 2 ) { alert('DEBUG 2'); } // DEBUG 2
    outputString += stringArray2[1];
    return outputString;
}
////////////////////////
function templateToHTML(template, tReps) {
    for ( var i=0; i<tReps.length; i++ ) {
        template = replaceFoo(template, tReps[i].startString, tReps[i].endString, document.getElementById(tReps[i].shortName).value);
    }
    return template;
}

function HTMLToTemplate() {
    var html = "<html><h1><!--pageTitleSTART-->qwer<!--pageTitleEND--></h1> <!--pageContentSTART-->asdf<!--pageContentEND--> <p><!--footerSTART-->zxcv<!--footerEND--></p></html>";

    // Split by HTML comments
    var myArray = html.split(/<!--[\s\S]*?-->/g); 
    alert(myArray);
/*
    var stringArray = html.split("END-->"); // Each element has a replacement except the last
    var template = "";
    var repShortNames = new Array();
    for( var i=0; i<(stringArray.length-1); i++ ) {
        var subStringArray = stringArray[i].split("START-->");
        var justHTML = subStringArray[1];
        alert('justHTML: ' + justHTML);
    }
    template += stringArray[stringArray.length-1];
*/
}
function foo() {
    var output = "";
    for ( var i=0; i<replacements.length; i++ ) {
        output += replacements[i].niceName;
        output += ": ";
        output += document.getElementById(replacements[i].shortName).value;
        output += "\n";
    }
    var foobar = templateToHTML(basicTemplate, replacements);
    alert(foobar);
}
function bar() {
    alert('hi');
}

function splitStringKeepDelimiters(myString, delimiter) {
    var template = "";
    var repNames = new Array();

    while (1==1) {

        // Split just once
        var word1 = myString.split(delimiter,1);
        alert(word1[0].length);
        var words2 = myString.split(delimiter,2);
        alert(words2);
        break;
    }
}
var sillyString = "Silly rabbit Trix are for kids!";
splitStringKeepDelimiters(sillyString, " ");


</script>
</head>

<body>
<input type='submit' value='Go!' onclick="foo()">
<br>
<p>Paste HTML code here to get back template and replacements:
<textarea rows="10" cols="100"></textarea></p>
<input type='submit' value='Go back!' onclick="bar()">
<br><br>
<input type="submit" value="click to test stuff!" onclick="HTMLToTemplate()">
</body>
</html>
